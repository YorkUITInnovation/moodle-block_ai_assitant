{"version":3,"file":"course_modules.min.js","sources":["../src/course_modules.js"],"sourcesContent":["import notification from 'core/notification';\nimport ajax from 'core/ajax';\nimport * as Str from 'core/str';\nimport jQuery from 'jquery';\n\nexport const init = () => {\n    display_modules();\n};\n\nfunction display_modules() {\n    document.getElementById('btn-ai-assistant-train-modules').addEventListener('click', function () {\n        // get data-courseid from current element\n        var courseid = this.getAttribute('data-courseid');\n\n        var display_modules = ajax.call([{\n            methodname: 'block_ai_assistant_display_course_modules',\n            args: {\n                'courseid': courseid\n            }\n        }]);\n\n        display_modules[0].done(function (results) {\n            // Pop up notificaiton to confirm delete\n            notification.confirm(Str.get_string('train_course_assistant', 'block_ai_assistant'),\n                results,\n                Str.get_string('save', 'block_ai_assistant'),\n                Str.get_string('cancel', 'block_ai_assistant'), function () {\n                    // Get all checkboxes with class courseModuleCheckbox and store the attribute data-filename, data-content, datacourseid for each checked checkbox\n                    var checkboxes = document.querySelectorAll('.courseModuleCheckbox');\n                    var selected_modules = [];\n                    checkboxes.forEach(function (checkbox) {\n                        if (checkbox.checked) {\n                            selected_modules.push({\n                                'filename': checkbox.getAttribute('data-filename'),\n                                'content': checkbox.getAttribute('data-content'),\n                                'courseid': checkbox.getAttribute('data-courseid'),\n                                'cmid': checkbox.getAttribute('data-cmid'),\n                                'modname': checkbox.getAttribute('data-modname'),\n                            });\n                            //make a new ajax call to a new webservice that calls insert from course_module class\n                            //block_ai_assistant_insert_course_modules\n\n\n                            var insert_modules = ajax.call([{\n                                methodname: 'block_ai_assistant_insert_course_modules',\n                                args: {\n                                    'courseid': courseid,\n                                    'selected_modules':selected_modules\n                                }\n\n                            }]);\n                            insert_modules[0].done(function(response){\n                                    console.log(\"response\", response);\n                                    alert(\"Successfully added, record id is: \" + response);\n                                    // You can now use the data variable for further processing\n                            }).fail(function(error){\n                                alert(\"error in ajax call of insert modules\" + error);\n                            });\n\n\n\n\n                        }\n                    });\n                    console.log(\"selected_module structure\",selected_modules);\n\n\n\n\n\n                    // var save_content = ajax.call([{\n                    //     methodname: 'block_ai_assistant_some_new_method',\n                    //     args: {\n                    //         'courseid': courseid\n                    //     }\n                    // }]);\n                    //\n                    // save_content[0].done(function () {\n                    //\n                    // }).fail(function () {\n                    //     alert('An error has occurred. The record was not deleted');\n                    // });\n                });\n        }).fail(function () {\n            alert('An error has occurred. Cannot display data');\n        });\n\n    });\n}\n\n\n"],"names":["document","getElementById","addEventListener","courseid","this","getAttribute","ajax","call","methodname","args","done","results","confirm","Str","get_string","checkboxes","querySelectorAll","selected_modules","forEach","checkbox","checked","push","response","console","log","alert","fail","error"],"mappings":"q3CAKoB,KAKhBA,SAASC,eAAe,kCAAkCC,iBAAiB,SAAS,eAE5EC,SAAWC,KAAKC,aAAa,iBAEXC,cAAKC,KAAK,CAAC,CAC7BC,WAAY,4CACZC,KAAM,UACUN,aAIJ,GAAGO,MAAK,SAAUC,+BAEjBC,QAAQC,IAAIC,WAAW,yBAA0B,sBAC1DH,QACAE,IAAIC,WAAW,OAAQ,sBACvBD,IAAIC,WAAW,SAAU,uBAAuB,eAExCC,WAAaf,SAASgB,iBAAiB,yBACvCC,iBAAmB,GACvBF,WAAWG,SAAQ,SAAUC,UACrBA,SAASC,UACTH,iBAAiBI,KAAK,UACNF,SAASd,aAAa,yBACvBc,SAASd,aAAa,yBACrBc,SAASd,aAAa,sBAC1Bc,SAASd,aAAa,qBACnBc,SAASd,aAAa,kBAMhBC,cAAKC,KAAK,CAAC,CAC5BC,WAAY,2CACZC,KAAM,UACUN,0BACOc,qBAIZ,GAAGP,MAAK,SAASY,UACxBC,QAAQC,IAAI,WAAYF,UACxBG,MAAM,qCAAuCH,aAElDI,MAAK,SAASC,OACbF,MAAM,uCAAyCE,cAQ3DJ,QAAQC,IAAI,4BAA4BP,wBAmBjDS,MAAK,WACJD,MAAM"}