{"version":3,"file":"course_modules.min.js","sources":["../src/course_modules.js"],"sourcesContent":["import notification from 'core/notification';\nimport ajax from 'core/ajax';\nimport * as Str from 'core/str';\n\nexport const init = () => {\n    display_modules();\n};\n\n/**\n * Display course modules\n */\nfunction display_modules() {\n    // Check to see if the button exists\n    if (!document.getElementById('btn-ai-assistant-train-modules')) {\n        return;\n    }\n    document.getElementById('btn-ai-assistant-train-modules').addEventListener('click', function () {\n        // get data-courseid from current element\n        var courseid = this.getAttribute('data-courseid');\n\n        var display_modules = ajax.call([{\n            methodname: 'block_ai_assistant_display_course_modules',\n            args: {\n                'courseid': courseid\n            }\n        }]);\n\n        display_modules[0].done(function (results) {\n            // Pop up notificaiton to confirm delete\n            notification.confirm(Str.get_string('train_course_assistant', 'block_ai_assistant'),\n                results,\n                Str.get_string('save', 'block_ai_assistant'),\n                Str.get_string('cancel', 'block_ai_assistant'), function () {\n                    // Get all checkboxes with class courseModuleCheckbox and store the attribute data-filename,\n                    // data-content, datacourseid for each checked checkbox\n                    var checkboxes = document.querySelectorAll('.courseModuleCheckbox');\n                    // Get the number of boxes checked\n                    var checkedCount = 0;\n                    checkboxes.forEach(function (checkbox) {\n                        if (checkbox.checked) {\n                            checkedCount++;\n                        }\n                    });\n\n                    var selected_modules = [];\n                    var currentNumberChecked = 0;\n                    checkboxes.forEach(function (checkbox) {\n                        if (checkbox.checked) {\n                            currentNumberChecked++;\n                            selected_modules.push({\n                                'filename': checkbox.getAttribute('data-filename'),\n                                'content': checkbox.getAttribute('data-content'),\n                                'courseid': checkbox.getAttribute('data-courseid'),\n                                'cmid': checkbox.getAttribute('data-cmid'),\n                                'modname': checkbox.getAttribute('data-modname'),\n                            });\n                            //make a new ajax call to a new webservice that calls insert from course_module class\n                            //block_ai_assistant_insert_course_modules\n                            var insert_modules = ajax.call([{\n                                methodname: 'block_ai_assistant_insert_course_modules',\n                                args: {\n                                    'courseid': courseid,\n                                    'selected_modules': selected_modules\n                                }\n\n                            }]);\n                            insert_modules[0].done(function (response) {\n                                if (currentNumberChecked === checkedCount) {\n                                    alert(\"Successfully added, record id is: \" + response);\n                                }\n                                // You can now use the data variable for further processing\n                            }).fail(function (error) {\n                                alert(\"error in ajax call of insert modules\" + error);\n                            });\n                        }\n                    });\n                });\n\n            // Time out required so that components can be discovered\n            setTimeout(function () {\n                // When button with class ai-aisstant-delete-content is clicked, perform ajax call to delete the content\n                var deleteButtons = document.querySelectorAll('.ai-aisstant-delete-content');\n                deleteButtons.forEach(function (button) {\n                    button.addEventListener('click', function () {\n                        // Get the data-cmid of the clicked button\n                        var dataBlockAiaCmid = this.getAttribute('data-block_aia_cmid');\n                        var uniqueCmid = this.getAttribute('data-cmid');\n                        // Add a notification pop up to confirm delete\n                        notification.confirm(Str.get_string('delete', 'block_ai_assistant'),\n                            Str.get_string('confirm_delete_trained_module', 'block_ai_assistant'),\n                            Str.get_string('delete', 'block_ai_assistant'),\n                            Str.get_string('no', 'block_ai_assistant'), function () {\n\n                                // Perform ajax call to delete the content\n                                var delete_content = ajax.call([{\n                                    methodname: 'block_ai_assistant_delete_course_modules',\n                                    args: {\n                                        'cmid': dataBlockAiaCmid\n                                    }\n                                }]);\n\n                                delete_content[0].done(function () {\n                                        // Hide element with id  block-aia-trained-status-uniqueCmid\n                                        var blockAiaTrainedStatus = document.getElementById(\n                                            'block-aia-trained-status-' + uniqueCmid);\n                                        blockAiaTrainedStatus.style.display = 'none';\n                                        // Hide element with id block-aia-delete-button-uniqueCmid\n                                        var blockAiaDeleteButton = document.getElementById('block-aia-delete-button-' + uniqueCmid);\n                                        blockAiaDeleteButton.style.display = 'none';\n                                        // Remove disable form element with id block-aia-uniqueCmid\n                                        var blockAiaUniqueCmid = document.getElementById('block-aia-' + uniqueCmid);\n                                        blockAiaUniqueCmid.removeAttribute('disabled');\n                                        alert(\"Successfully deleted\");\n                                }).fail(function (error) {\n                                    alert(\"error in ajax call of delete modules\" + error);\n                                });\n                            });\n                    });\n                });\n\n\n                // Get all elements with the class 'blockAiAssistant'\n                var blocks = document.querySelectorAll('.blockAiAssistant');\n                // Add click event listener to each block\n                blocks.forEach(function (block) {\n                    block.addEventListener('click', function () {\n                        // Get the data-id of the clicked block\n                        var dataId = this.getAttribute('data-id');\n\n                        // Construct the class name of the corresponding content block\n                        var contentClassName = 'blockAiAssistantContent-' + dataId;\n\n                        // Get the content block element\n                        var contentBlock = document.querySelector('.' + contentClassName);\n\n                        var folderIcon = this.querySelector('.blockAiAssistantFolderIcon');\n\n                        // Toggle the display property of the content block\n                        if (contentBlock.style.display === 'none' || contentBlock.style.display === '') {\n                            contentBlock.style.display = 'block';\n                            // Change the icon to a folder open icon\n                            folderIcon.classList.remove('fa-folder');\n                            folderIcon.classList.add('fa-folder-open');\n                        } else {\n                            contentBlock.style.display = 'none';\n                            // Change the icon to a folder closed icon\n                            folderIcon.classList.remove('fa-folder-open');\n                            folderIcon.classList.add('fa-folder');\n                        }\n                    });\n                });\n\n\n            }, 1000);\n\n        }).fail(function () {\n            alert('An error has occurred. Cannot display data');\n        });\n\n    });\n}\n\n\n"],"names":["_getRequireWildcardCache","e","WeakMap","r","t","_interopRequireDefault","__esModule","default","_notification","_ajax","Str","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_interopRequireWildcard","_exports","init","document","getElementById","addEventListener","courseid","this","getAttribute","ajax","methodname","args","done","results","notification","confirm","get_string","checkboxes","querySelectorAll","checkedCount","forEach","checkbox","checked","selected_modules","currentNumberChecked","push","filename","content","cmid","modname","response","alert","fail","error","setTimeout","button","dataBlockAiaCmid","uniqueCmid","style","display","removeAttribute","block","contentClassName","contentBlock","querySelector","folderIcon","classList","remove","add","display_modules"],"mappings":"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"}